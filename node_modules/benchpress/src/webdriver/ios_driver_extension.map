{"version":3,"sources":["ios_driver_extension.js","@traceur/generated/TemplateParser/21","@traceur/generated/TemplateParser/19","@traceur/generated/TemplateParser/11","@traceur/generated/TemplateParser/2","@traceur/generated/TemplateParser/20","@traceur/generated/TemplateParser/5","@traceur/generated/TemplateParser/1","@traceur/generated/TemplateParser/13","@traceur/generated/TemplateParser/9","@traceur/generated/TemplateParser/15","@traceur/generated/TemplateParser/17","@traceur/generated/TemplateParser/16","@traceur/generated/TemplateParser/7","@traceur/generated/TemplateParser/10","@traceur/generated/TemplateParser/8"],"names":[],"mappings":"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","file":"/Users/tbosch/projects/angular2/modules/benchpress/src/webdriver/ios_driver_extension.js","sourceRoot":"/Users/tbosch/projects/angular2/modules/benchpress/src/webdriver/","sourcesContent":["import { bind } from 'angular2/di';\nimport { ListWrapper, StringMap } from 'angular2/src/facade/collection';\nimport {\n  Json, isPresent, isBlank, RegExpWrapper, StringWrapper\n} from 'angular2/src/facade/lang';\n\nimport { WebDriverExtension } from '../web_driver_extension';\nimport { WebDriverAdapter } from '../web_driver_adapter';\nimport { Promise } from 'angular2/src/facade/async';\n\n\nexport class IOsDriverExtension extends WebDriverExtension {\n  // TODO(tbosch): use static values when our transpiler supports them\n  static get BINDINGS() { return _BINDINGS; }\n\n  _driver:WebDriverAdapter;\n\n  constructor(driver:WebDriverAdapter) {\n    super();\n    this._driver = driver;\n  }\n\n  gc() {\n    return this._driver.executeScript('window.gc()');\n  }\n\n  timeBegin(name:string):Promise {\n    return this._driver.executeScript(`console.time('${name}');`);\n  }\n\n  timeEnd(name:string, restartName:string = null):Promise {\n    var script = `console.timeEnd('${name}');`;\n    if (isPresent(restartName)) {\n      script += `console.time('${restartName}');`\n    }\n    return this._driver.executeScript(script);\n  }\n\n  // See https://github.com/WebKit/webkit/tree/master/Source/WebInspectorUI/Versions\n  readPerfLog() {\n    // TODO(tbosch): Bug in IOsDriver: Need to execute at least one command\n    // so that the browser logs can be read out!\n    return this._driver.executeScript('1+1')\n      .then( (_) => this._driver.logs('performance') )\n      .then( (entries) => {\n        var records = [];\n        ListWrapper.forEach(entries, function(entry) {\n          var message = Json.parse(entry['message'])['message'];\n          if (StringWrapper.equals(message['method'], 'Timeline.eventRecorded')) {\n            ListWrapper.push(records, message['params']['record']);\n          }\n        });\n        return this._convertPerfRecordsToEvents(records);\n      });\n  }\n\n  _convertPerfRecordsToEvents(records, events = null) {\n    if (isBlank(events)) {\n      events = [];\n    }\n    records.forEach( (record) => {\n      var endEvent = null;\n      var type = record['type'];\n      var data = record['data'];\n      var startTime = record['startTime'];\n      var endTime = record['endTime'];\n\n      if (StringWrapper.equals(type, 'FunctionCall') &&\n          (isBlank(data) || !StringWrapper.equals(data['scriptName'], 'InjectedScript'))) {\n        ListWrapper.push(events, createStartEvent('script', startTime));\n        endEvent = createEndEvent('script', endTime);\n      } else if (StringWrapper.equals(type, 'Time')) {\n        ListWrapper.push(events, createMarkStartEvent(data['message'], startTime));\n      } else if (StringWrapper.equals(type, 'TimeEnd')) {\n        ListWrapper.push(events, createMarkEndEvent(data['message'], startTime));\n      } else if (StringWrapper.equals(type, 'RecalculateStyles') ||\n        StringWrapper.equals(type, 'Layout') ||\n        StringWrapper.equals(type, 'UpdateLayerTree') ||\n        StringWrapper.equals(type, 'Paint') ||\n        StringWrapper.equals(type, 'Rasterize') ||\n        StringWrapper.equals(type, 'CompositeLayers')) {\n        ListWrapper.push(events, createStartEvent('render', startTime));\n        endEvent = createEndEvent('render', endTime);\n      } else if (StringWrapper.equals(type, 'GCEvent')) {\n        ListWrapper.push(events, createStartEvent('gc', startTime, {\n          'usedHeapSize': 0\n        }));\n        endEvent = createEndEvent('gc', endTime, {\n          'usedHeapSize': -data['usedHeapSizeDelta']\n        });\n      }\n      if (isPresent(record['children'])) {\n        this._convertPerfRecordsToEvents(record['children'], events);\n      }\n      if (isPresent(endEvent)) {\n        ListWrapper.push(events, endEvent);\n      }\n    });\n    return events;\n  }\n\n  supports(capabilities:StringMap):boolean {\n    return StringWrapper.equals(capabilities['browserName'].toLowerCase(), 'safari');\n  }\n}\n\nfunction createEvent(ph, name, time, args = null) {\n  var result = {\n    'cat': 'timeline',\n    'name': name,\n    'ts': time,\n    'ph': ph,\n    // The ios protocol does not support the notions of multiple processes in\n    // the perflog...\n    'pid': 'pid0'\n  };\n  if (isPresent(args)) {\n    result['args'] = args;\n  }\n  return result;\n}\n\nfunction createStartEvent(name, time, args = null) {\n  return createEvent('B', name, time, args);\n}\n\nfunction createEndEvent(name, time, args = null) {\n  return createEvent('E', name, time, args);\n}\n\nfunction createMarkStartEvent(name, time) {\n  return createEvent('b', name, time);\n}\n\nfunction createMarkEndEvent(name, time) {\n  return createEvent('e', name, time);\n}\n\nvar _BINDINGS = [\n  bind(IOsDriverExtension).toFactory(\n    (driver) => new IOsDriverExtension(driver),\n    [WebDriverAdapter]\n  )\n];","Object.defineProperties(module.exports, $__placeholder__0);","{get: $__placeholder__0}","get $__placeholder__0() { return $__placeholder__1; }","__esModule: true","{value: $__placeholder__0}","var __moduleName = $__placeholder__0;","($__placeholder__0 = require($__placeholder__1),\n        $__placeholder__2 && $__placeholder__3.__esModule && $__placeholder__4 || {default: $__placeholder__5})","var $__placeholder__0 = $__placeholder__1","assert.argumentTypes($__placeholder__0)","$traceurRuntime.superConstructor($__placeholder__0).call($__placeholder__1)","var $__placeholder__0 = $__placeholder__1","($traceurRuntime.createClass)($__placeholder__0, $__placeholder__1, $__placeholder__2,\n                                       $__placeholder__3)","assert.type.$__placeholder__0)","return assert.returnType(($__placeholder__0), $__placeholder__1)","Object.defineProperty($__placeholder__0, $__placeholder__1,\n        {get: function() {return $__placeholder__2}});"]}