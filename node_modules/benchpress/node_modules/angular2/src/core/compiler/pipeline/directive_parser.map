{"version":3,"sources":["directive_parser.js","@traceur/generated/TemplateParser/21","@traceur/generated/TemplateParser/19","@traceur/generated/TemplateParser/11","@traceur/generated/TemplateParser/2","@traceur/generated/TemplateParser/20","@traceur/generated/TemplateParser/5","@traceur/generated/TemplateParser/1","@traceur/generated/TemplateParser/13","@traceur/generated/TemplateParser/9","@traceur/generated/TemplateParser/25","@traceur/generated/TemplateParser/15","@traceur/generated/TemplateParser/17","@traceur/generated/TemplateParser/16","@traceur/generated/TemplateParser/8"],"names":[],"mappings":"AAAA;ACAA,KAAK,iBAAiB,AAAC,CAAC,MAAK,QAAQ;iBCArC,EAAC,GAAE,YCAqB;AAAE,4BAAwB;IAAE,ADA9B,CAAC;AEAvB,WAAS,CCAT,EAAC,KAAI,CDAO,KAAG,ACAS,CAAC;CJAgC,CAAC;AKA1D,AAAI,EAAA,CAAA,YAAW,yDAAoB,CAAC;;;;;;;;;;;;WCApC,EAAC,uCAAoB,CAAA,OAAM,AAAC,2BAAkB,CACtC,CAAA,wCAAqB,iDAA2B,CAAA,wCAAqB,GAAK,EAAC,OAAM,uCAAmB,CAAC,AAD/D,CACgE;SAD9G,EAAC,wCAAoB,CAAA,OAAM,AAAC,4BAAkB,CACtC,CAAA,yCAAqB,kDAA2B,CAAA,yCAAqB,GAAK,EAAC,OAAM,wCAAmB,CAAC,AAD/D,CACgE;APDtG,YAAQ;AAAG,UAAM;AAAG,gBAAY;SOAxC,EAAC,8CAAoB,CAAA,OAAM,AAAC,kCAAkB,CACtC,CAAA,+CAAqB,wDAA2B,CAAA,+CAAqB,GAAK,EAAC,OAAM,8CAAmB,CAAC,AAD/D,CACgE;APAtG,OAAG;AAAG,aAAS;EACf,IAAE,EOFV,EAAC,uCAAoB,CAAA,OAAM,AAAC,2BAAkB,CACtC,CAAA,wCAAqB,iDAA2B,CAAA,wCAAqB,GAAK,EAAC,OAAM,uCAAmB,CAAC,AAD/D,CACgE;EPEtG,gBAAc,EOHtB,EAAC,sDAAoB,CAAA,OAAM,AAAC,eAAkB,CACtC,CAAA,uDAAqB,gEAA2B,CAAA,uDAAqB,GAAK,EAAC,OAAM,sDAAmB,CAAC,AAD/D,CACgE;EPGtG,YAAU,EOJlB,EAAC,sDAAoB,CAAA,OAAM,AAAC,eAAkB,CACtC,CAAA,uDAAqB,gEAA2B,CAAA,uDAAqB,GAAK,EAAC,OAAM,sDAAmB,CAAC,AAD/D,CACgE;EPKtG,kBAAgB,EONxB,EAAC,mEAAoB,CAAA,OAAM,AAAC,yBAAkB,CACtC,CAAA,oEAAqB,6EAA2B,CAAA,oEAAqB,GAAK,EAAC,OAAM,mEAAmB,CAAC,AAD/D,CACgE;SAD9G,EAAC,4DAAoB,CAAA,OAAM,AAAC,iCAAkB,CACtC,CAAA,6DAAqB,sEAA2B,CAAA,6DAAqB,GAAK,EAAC,OAAM,4DAAmB,CAAC,AAD/D,CACgE;APMtG,YAAQ;AAAG,WAAO;EAClB,YAAU,EORlB,EAAC,yEAAoB,CAAA,OAAM,AAAC,kBAAkB,CACtC,CAAA,0EAAqB,mFAA2B,CAAA,0EAAqB,GAAK,EAAC,OAAM,yEAAmB,CAAC,AAD/D,CACgE;EPQtG,eAAa,EOTrB,EAAC,4EAAoB,CAAA,OAAM,AAAC,qBAAkB,CACtC,CAAA,6EAAqB,sFAA2B,CAAA,6EAAqB,GAAK,EAAC,OAAM,4EAAmB,CAAC,AAD/D,CACgE;EPStG,eAAa,EOVrB,EAAC,4EAAoB,CAAA,OAAM,AAAC,qBAAkB,CACtC,CAAA,6EAAqB,sFAA2B,CAAA,6EAAqB,GAAK,EAAC,OAAM,4EAAmB,CAAC,AAD/D,CACgE;ACD9G,AAAI,EAAA,kBR2BG,SAAM,gBAAc,CAEb,UAAS,AAAwB,CAAG;AS7BlD,OAAK,cAAc,YCAnB,CAAA,MAAK,YAAY,AV6BQ,CAAA,IAAG,CAAE,kBAAgB,CAAC,AU7BX,CDAE,CAAA;AT8BlC,AW9BJ,gBAAc,iBAAiB,AAAC,kBAAkB,KAAK,MAAmB,CX8B/D;AACP,KAAG,iBAAiB,EAAI,IAAI,gBAAc,AAAC,EAAC,CAAC;AAC7C,MAAS,GAAA,CAAA,CAAA,EAAE,EAAA,CAAG,CAAA,CAAA,EAAE,CAAA,UAAS,OAAO,CAAG,CAAA,CAAA,EAAE,CAAG;AACtC,AAAI,MAAA,CAAA,iBAAgB,EAAI,CAAA,UAAS,CAAE,CAAA,CAAC,CAAC;AACrC,OAAG,iBAAiB,cAAc,AAAC,CACjC,WAAU,MAAM,AAAC,CAAC,iBAAgB,WAAW,SAAS,CAAC,CACvD,kBAAgB,CAClB,CAAC;EACH;AAAA,AACF,AQvCsC,CAAA;AIAxC,AAAI,EAAA,mCAAoC,CAAA;ACAxC,AAAC,eAAc,YAAY,CAAC,AAAC,mBbyC3B,OAAM,CAAN,UAAQ,MAAK,AAAe,CAAG,CAAA,OAAM,AAAe,CAAG,CAAA,OAAM,AAAe;ASzC9E,SAAK,cAAc,QTyCF,eAAa,UAAW,eAAa,UAAW,eAAa,CSzCxC,CAAA;AT0ClC,AAAI,MAAA,CAAA,KAAI,EAAI,CAAA,OAAM,MAAM,AAAC,EAAC,CAAC;AAC3B,AAAI,MAAA,CAAA,SAAQ,EAAI,CAAA,OAAM,UAAU,AAAC,EAAC,CAAC;AAEnC,AAAI,MAAA,CAAA,WAAU,EAAI,IAAI,YAAU,AAAC,EAAC,CAAC;AACnC,cAAU,WAAW,AAAC,CAAC,GAAE,SAAS,AAAC,CAAC,OAAM,QAAQ,CAAC,CAAC,CAAC;AACrD,QAAS,GAAA,CAAA,CAAA,EAAE,EAAA,CAAG,CAAA,CAAA,EAAI,CAAA,SAAQ,OAAO,CAAG,CAAA,CAAA,EAAE,CAAG;AACvC,gBAAU,aAAa,AAAC,CAAC,SAAQ,CAAE,CAAA,CAAC,CAAC,CAAC;IACxC;AAAA,AACA,aAAS,QAAQ,AAAC,CAAC,KAAI,GAAG,SAAC,SAAQ,CAAG,CAAA,QAAO,CAAM;AACjD,SAAI,OAAM,AAAC,CAAC,OAAM,iBAAiB,CAAC,CAAA,EAClC,CAAA,SAAQ,AAAC,CAAC,OAAM,iBAAiB,CAAC,CAAA,EAAK,EAAC,UAAS,SAAS,AAAC,CAAC,OAAM,iBAAiB,CAAG,SAAO,CAAC,CAAG;AACjG,kBAAU,aAAa,AAAC,CAAC,QAAO,CAAG,UAAQ,CAAC,CAAC;MAC/C;AAAA,IACF,EAAC,CAAC;AACF,OAAI,SAAQ,AAAC,CAAC,OAAM,iBAAiB,CAAC,CAAG;AACvC,eAAS,QAAQ,AAAC,CAAC,OAAM,iBAAiB,GAAG,SAAC,UAAS,CAAG,CAAA,IAAG,CAAM;AACjE,kBAAU,aAAa,AAAC,CAAC,IAAG,CAAG,CAAA,UAAS,OAAO,CAAC,CAAC;MACnD,EAAC,CAAC;IACJ;AAAA,AACA,OAAI,SAAQ,AAAC,CAAC,OAAM,iBAAiB,CAAC,CAAG;AACvC,eAAS,QAAQ,AAAC,CAAC,OAAM,iBAAiB,GAAG,SAAC,KAAI,CAAG,CAAA,IAAG,CAAM;AAC5D,kBAAU,aAAa,AAAC,CAAC,IAAG,CAAG,MAAI,CAAC,CAAC;MACvC,EAAC,CAAC;IACJ;AAAA,AAGI,MAAA,CAAA,iBAAgB,EAAI,CAAA,GAAE,kBAAkB,AAAC,CAAC,OAAM,QAAQ,CAAC,CAAC;AAC9D,OAAG,iBAAiB,MAAM,AAAC,CAAC,WAAU,GAAG,SAAC,SAAQ,CAAM;AACtD,SAAI,SAAQ,WAAW,WAAa,SAAO,CAAG;AAC5C,WAAI,CAAC,iBAAgB,CAAG;AACtB,cAAM,IAAI,cAAY,AAAC,CAAC,mGAAkG,CAAC,CAAC;QAC9H,KAAO,KAAI,SAAQ,AAAC,CAAC,OAAM,kBAAkB,CAAC,CAAG;AAC/C,cAAM,IAAI,cAAY,AAAC,CAAC,qDAAoD,CAAC,CAAC;QAChF;AAAA,MACF,KAAO,KAAI,iBAAgB,CAAG;AAC5B,YAAM,IAAI,cAAY,AAAC,CAAC,8DAA6D,CAAC,CAAC;MACzF,KAAO,KAAI,CAAC,SAAQ,WAAW,WAAa,UAAQ,CAAC,GAAK,CAAA,SAAQ,AAAC,CAAC,OAAM,mBAAmB,CAAC,CAAG;AAC/F,YAAM,IAAI,cAAY,AAAC,CAAC,sDAAqD,CAAC,CAAC;MACjF;AAAA,AACA,YAAM,aAAa,AAAC,CAAC,SAAQ,CAAC,CAAC;IACjC,EAAC,CAAC;EACJ,MAxDmC,YAAU,Ca1BS;ACDxD,KAAK,eAAe,AAAC,+BACb,EAAC,GAAE,CAAG,UAAS,AAAD,CAAG;AAAC,YJD1B,MAAK,YAAY,AV6BQ,CAAA,IAAG,CAAE,kBAAgB,CAAC,AU7BX,GICa;EAAC,CAAC,CAAC,CAAC;AADrD,KAAK,eAAe,AAAC,iDACb,EAAC,GAAE,CAAG,UAAS,AAAD,CAAG;AAAC,YdwCT,cAAa,IAAW,cAAa,IAAW,cAAa,GcxC7B;EAAC,CAAC,CAAC,CAAC;AdoFrD","file":"/Users/tbosch/projects/angular2/modules/angular2/src/core/compiler/pipeline/directive_parser.js","sourceRoot":"/Users/tbosch/projects/angular2/modules/angular2/src/core/compiler/pipeline/","sourcesContent":["import {isPresent, isBlank, BaseException} from 'angular2/src/facade/lang';\nimport {List, MapWrapper} from 'angular2/src/facade/collection';\nimport {DOM} from 'angular2/src/facade/dom';\nimport {SelectorMatcher} from '../selector';\nimport {CssSelector} from '../selector';\n\nimport {DirectiveMetadata} from '../directive_metadata';\nimport {Component, Viewport} from '../../annotations/annotations';\nimport {CompileStep} from './compile_step';\nimport {CompileElement} from './compile_element';\nimport {CompileControl} from './compile_control';\n\n/**\n * Parses the directives on a single element. Assumes ViewSplitter has already created\n * <template> elements for template directives.\n *\n * Fills:\n * - CompileElement#decoratorDirectives\n * - CompileElement#templateDirecitve\n * - CompileElement#componentDirective.\n *\n * Reads:\n * - CompileElement#propertyBindings (to find directives contained\n *   in the property bindings)\n * - CompileElement#variableBindings (to find directives contained\n *   in the variable bindings)\n */\nexport class DirectiveParser extends CompileStep {\n  _selectorMatcher:SelectorMatcher;\n  constructor(directives:List<DirectiveMetadata>) {\n    super();\n    this._selectorMatcher = new SelectorMatcher();\n    for (var i=0; i<directives.length; i++) {\n      var directiveMetadata = directives[i];\n      this._selectorMatcher.addSelectable(\n        CssSelector.parse(directiveMetadata.annotation.selector),\n        directiveMetadata\n      );\n    }\n  }\n\n  process(parent:CompileElement, current:CompileElement, control:CompileControl) {\n    var attrs = current.attrs();\n    var classList = current.classList();\n\n    var cssSelector = new CssSelector();\n    cssSelector.setElement(DOM.nodeName(current.element));\n    for (var i=0; i < classList.length; i++) {\n      cssSelector.addClassName(classList[i]);\n    }\n    MapWrapper.forEach(attrs, (attrValue, attrName) => {\n      if (isBlank(current.propertyBindings) ||\n        isPresent(current.propertyBindings) && !MapWrapper.contains(current.propertyBindings, attrName)) {\n        cssSelector.addAttribute(attrName, attrValue);\n      }\n    });\n    if (isPresent(current.propertyBindings)) {\n      MapWrapper.forEach(current.propertyBindings, (expression, prop) => {\n        cssSelector.addAttribute(prop, expression.source);\n      });\n    }\n    if (isPresent(current.variableBindings)) {\n      MapWrapper.forEach(current.variableBindings, (value, name) => {\n        cssSelector.addAttribute(name, value);\n      });\n    }\n    // Note: We assume that the ViewSplitter already did its work, i.e. template directive should\n    // only be present on <template> elements any more!\n    var isTemplateElement = DOM.isTemplateElement(current.element);\n    this._selectorMatcher.match(cssSelector, (directive) => {\n      if (directive.annotation instanceof Viewport) {\n        if (!isTemplateElement) {\n          throw new BaseException('Viewport directives need to be placed on <template> elements or elements with template attribute!');\n        } else if (isPresent(current.viewportDirective)) {\n          throw new BaseException('Only one template directive per element is allowed!');\n        }\n      } else if (isTemplateElement) {\n        throw new BaseException('Only template directives are allowed on <template> elements!');\n      } else if ((directive.annotation instanceof Component) && isPresent(current.componentDirective)) {\n        throw new BaseException('Only one component directive per element is allowed!');\n      }\n      current.addDirective(directive);\n    });\n  }\n}\n","Object.defineProperties(module.exports, $__placeholder__0);","{get: $__placeholder__0}","get $__placeholder__0() { return $__placeholder__1; }","__esModule: true","{value: $__placeholder__0}","var __moduleName = $__placeholder__0;","($__placeholder__0 = require($__placeholder__1),\n        $__placeholder__2 && $__placeholder__3.__esModule && $__placeholder__4 || {default: $__placeholder__5})","var $__placeholder__0 = $__placeholder__1","assert.argumentTypes($__placeholder__0)","assert.genericType($__placeholder__0)","$traceurRuntime.superConstructor($__placeholder__0).call($__placeholder__1)","var $__placeholder__0 = $__placeholder__1","($traceurRuntime.createClass)($__placeholder__0, $__placeholder__1, $__placeholder__2,\n                                       $__placeholder__3)","Object.defineProperty($__placeholder__0, $__placeholder__1,\n        {get: function() {return $__placeholder__2}});"]}