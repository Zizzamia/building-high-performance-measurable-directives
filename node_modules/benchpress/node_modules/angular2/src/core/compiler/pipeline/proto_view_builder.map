{"version":3,"sources":["proto_view_builder.js","@traceur/generated/TemplateParser/21","@traceur/generated/TemplateParser/19","@traceur/generated/TemplateParser/11","@traceur/generated/TemplateParser/2","@traceur/generated/TemplateParser/20","@traceur/generated/TemplateParser/5","@traceur/generated/TemplateParser/1","@traceur/generated/TemplateParser/13","@traceur/generated/TemplateParser/9","@traceur/generated/TemplateParser/15","@traceur/generated/TemplateParser/17","@traceur/generated/TemplateParser/16","@traceur/generated/TemplateParser/8"],"names":[],"mappings":"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","file":"/Users/tbosch/projects/angular2/modules/angular2/src/core/compiler/pipeline/proto_view_builder.js","sourceRoot":"/Users/tbosch/projects/angular2/modules/angular2/src/core/compiler/pipeline/","sourcesContent":["import {isPresent, BaseException} from 'angular2/src/facade/lang';\nimport {ListWrapper, MapWrapper} from 'angular2/src/facade/collection';\n\nimport {ProtoView} from '../view';\nimport {ChangeDetection} from 'angular2/change_detection';\n\nimport {CompileStep} from './compile_step';\nimport {CompileElement} from './compile_element';\nimport {CompileControl} from './compile_control';\nimport {ShadowDomStrategy} from '../shadow_dom_strategy';\n\n/**\n * Creates ProtoViews and forwards variable bindings from parent to children.\n *\n * Fills:\n * - (in parent): CompileElement#inheritedElementBinder.nestedProtoView\n * - CompileElement#inheritedProtoView\n *\n * Reads:\n * - (in parent): CompileElement#inheritedProtoView\n * - (in parent): CompileElement#variableBindings\n * - CompileElement#isViewRoot\n */\nexport class ProtoViewBuilder extends CompileStep {\n  changeDetection:ChangeDetection;\n  _shadowDomStrategy:ShadowDomStrategy;\n  constructor(changeDetection:ChangeDetection, shadowDomStrategy:ShadowDomStrategy) {\n    super();\n    this._shadowDomStrategy = shadowDomStrategy;\n    this.changeDetection = changeDetection;\n  }\n\n  process(parent:CompileElement, current:CompileElement, control:CompileControl) {\n    var inheritedProtoView = null;\n    if (current.isViewRoot) {\n      var protoChangeDetector = this.changeDetection.createProtoChangeDetector('dummy');\n      inheritedProtoView = new ProtoView(current.element, protoChangeDetector,\n        this._shadowDomStrategy);\n      if (isPresent(parent)) {\n        if (isPresent(parent.inheritedElementBinder.nestedProtoView)) {\n          throw new BaseException('Only one nested view per element is allowed');\n        }\n        parent.inheritedElementBinder.nestedProtoView = inheritedProtoView;\n\n        // When current is a view root, the variable bindings are set to the *nested* proto view.\n        // The root view conceptually signifies a new \"block scope\" (the nested view), to which\n        // the variables are bound.\n        if (isPresent(parent.variableBindings)) {\n          MapWrapper.forEach(parent.variableBindings, (mappedName, varName) => {\n            inheritedProtoView.bindVariable(varName, mappedName);\n          });\n        }\n      }\n    } else if (isPresent(parent)) {\n      inheritedProtoView = parent.inheritedProtoView;\n    }\n\n    // The view's contextWithLocals needs to have a full set of variable names at construction time\n    // in order to prevent new variables from being set later in the lifecycle. Since we don't want\n    // to actually create variable bindings for the $implicit bindings, add to the\n    // protoContextLocals manually.\n    if (isPresent(current.variableBindings)) {\n      MapWrapper.forEach(current.variableBindings, (mappedName, varName) => {\n        MapWrapper.set(inheritedProtoView.protoContextLocals, mappedName, null);\n      });\n    }\n\n    current.inheritedProtoView = inheritedProtoView;\n  }\n}\n","Object.defineProperties(module.exports, $__placeholder__0);","{get: $__placeholder__0}","get $__placeholder__0() { return $__placeholder__1; }","__esModule: true","{value: $__placeholder__0}","var __moduleName = $__placeholder__0;","($__placeholder__0 = require($__placeholder__1),\n        $__placeholder__2 && $__placeholder__3.__esModule && $__placeholder__4 || {default: $__placeholder__5})","var $__placeholder__0 = $__placeholder__1","assert.argumentTypes($__placeholder__0)","$traceurRuntime.superConstructor($__placeholder__0).call($__placeholder__1)","var $__placeholder__0 = $__placeholder__1","($traceurRuntime.createClass)($__placeholder__0, $__placeholder__1, $__placeholder__2,\n                                       $__placeholder__3)","Object.defineProperty($__placeholder__0, $__placeholder__1,\n        {get: function() {return $__placeholder__2}});"]}