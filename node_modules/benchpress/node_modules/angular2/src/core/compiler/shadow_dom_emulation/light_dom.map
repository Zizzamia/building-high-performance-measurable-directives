{"version":3,"sources":["light_dom.js","@traceur/generated/TemplateParser/21","@traceur/generated/TemplateParser/19","@traceur/generated/TemplateParser/11","@traceur/generated/TemplateParser/2","@traceur/generated/TemplateParser/20","@traceur/generated/TemplateParser/5","@traceur/generated/TemplateParser/1","@traceur/generated/TemplateParser/13","@traceur/generated/TemplateParser/14","@traceur/generated/TemplateParser/9","@traceur/generated/TemplateParser/10","@traceur/generated/TemplateParser/25","@traceur/generated/TemplateParser/8"],"names":[],"mappings":"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","file":"/Users/tbosch/projects/angular2/modules/angular2/src/core/compiler/shadow_dom_emulation/light_dom.js","sourceRoot":"/Users/tbosch/projects/angular2/modules/angular2/src/core/compiler/shadow_dom_emulation/","sourcesContent":["import {Element, Node, DOM} from 'angular2/src/facade/dom';\nimport {List, ListWrapper} from 'angular2/src/facade/collection';\nimport {isBlank, isPresent} from 'angular2/src/facade/lang';\n\nimport {View} from '../view';\nimport {ElementInjector} from '../element_injector';\nimport {ViewContainer} from '../view_container';\nimport {Content} from './content_tag';\n\nexport class SourceLightDom {}\nexport class DestinationLightDom {}\n\n\nclass _Root {\n  node:Node;\n  injector:ElementInjector;\n\n  constructor(node, injector) {\n    this.node = node;\n    this.injector = injector;\n  }\n}\n\n// TODO: LightDom should implement SourceLightDom and DestinationLightDom\n// once interfaces are supported\nexport class LightDom {\n  // The light DOM of the element is enclosed inside the lightDomView\n  lightDomView:View;\n  // The shadow DOM\n  shadowDomView:View;\n  // The nodes of the light DOM\n  nodes:List<Node>;\n  roots:List<_Root>;\n\n  constructor(lightDomView:View, shadowDomView:View, element:Element) {\n    this.lightDomView = lightDomView;\n    this.shadowDomView = shadowDomView;\n    this.nodes = DOM.childNodesAsList(element);\n    this.roots = null;\n  }\n\n  redistribute() {\n    var tags = this.contentTags();\n    if (tags.length > 0) {\n      redistributeNodes(tags, this.expandedDomNodes());\n    }\n  }\n\n  contentTags(): List<Content> {\n    return this._collectAllContentTags(this.shadowDomView, []);\n  }\n\n  // Collects the Content directives from the view and all its child views\n  _collectAllContentTags(view: View, acc:List<Content>):List<Content> {\n    var eis = view.elementInjectors;\n    for (var i = 0; i < eis.length; ++i) {\n      var ei = eis[i];\n      if (isBlank(ei)) continue;\n\n      if (ei.hasDirective(Content)) {\n        ListWrapper.push(acc, ei.get(Content));\n\n      } else if (ei.hasPreBuiltObject(ViewContainer)) {\n        var vc = ei.get(ViewContainer);\n        ListWrapper.forEach(vc.contentTagContainers(), (view) => {\n          this._collectAllContentTags(view, acc);\n        });\n      }\n    }\n    return acc;\n  }\n\n  // Collects the nodes of the light DOM by merging:\n  // - nodes from enclosed ViewContainers,\n  // - nodes from enclosed content tags,\n  // - plain DOM nodes\n  expandedDomNodes():List {\n    var res = [];\n\n    var roots = this._roots();\n    for (var i = 0; i < roots.length; ++i) {\n\n      var root = roots[i];\n      var ei = root.injector;\n\n      if (isPresent(ei) && ei.hasPreBuiltObject(ViewContainer)) {\n        var vc = root.injector.get(ViewContainer);\n        res = ListWrapper.concat(res, vc.nodes());\n\n      } else if (isPresent(ei) && ei.hasDirective(Content)) {\n        var content = root.injector.get(Content);\n        res = ListWrapper.concat(res, content.nodes());\n\n      } else {\n        ListWrapper.push(res, root.node);\n      }\n    }\n    return res;\n  }\n\n  // Returns a list of Roots for all the nodes of the light DOM.\n  // The Root object contains the DOM node and its corresponding injector (could be null).\n  _roots() {\n    if (isPresent(this.roots)) return this.roots;\n\n    var viewInj = this.lightDomView.elementInjectors;\n    this.roots = ListWrapper.map(this.nodes, (n) =>\n      new _Root(n, ListWrapper.find(viewInj,\n        (inj) => isPresent(inj) ? inj.forElement(n) : false)));\n\n    return this.roots;\n  }\n}\n\n// Projects the light DOM into the shadow DOM\nfunction redistributeNodes(contents:List<Content>, nodes:List<Node>) {\n  for (var i = 0; i < contents.length; ++i) {\n    var content = contents[i];\n    var select = content.select;\n    var matchSelector = (n) => DOM.elementMatches(n, select);\n\n    if (isBlank(select)) {\n      content.insert(nodes);\n      ListWrapper.clear(nodes);\n\n    } else {\n      var matchingNodes = ListWrapper.filter(nodes, matchSelector);\n      content.insert(matchingNodes);\n      ListWrapper.removeAll(nodes, matchingNodes);\n    }\n  }\n}\n","Object.defineProperties(module.exports, $__placeholder__0);","{get: $__placeholder__0}","get $__placeholder__0() { return $__placeholder__1; }","__esModule: true","{value: $__placeholder__0}","var __moduleName = $__placeholder__0;","($__placeholder__0 = require($__placeholder__1),\n        $__placeholder__2 && $__placeholder__3.__esModule && $__placeholder__4 || {default: $__placeholder__5})","var $__placeholder__0 = $__placeholder__1","($traceurRuntime.createClass)($__placeholder__0, $__placeholder__1, $__placeholder__2)","assert.argumentTypes($__placeholder__0)","return assert.returnType(($__placeholder__0), $__placeholder__1)","assert.genericType($__placeholder__0)","Object.defineProperty($__placeholder__0, $__placeholder__1,\n        {get: function() {return $__placeholder__2}});"]}