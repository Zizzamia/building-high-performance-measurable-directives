{"version":3,"sources":["vm_turn_zone.es6","@traceur/generated/TemplateParser/21","@traceur/generated/TemplateParser/19","@traceur/generated/TemplateParser/11","@traceur/generated/TemplateParser/2","@traceur/generated/TemplateParser/20","@traceur/generated/TemplateParser/5","@traceur/generated/TemplateParser/1","@traceur/generated/TemplateParser/13","@traceur/generated/TemplateParser/14"],"names":[],"mappings":"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","file":"/Users/tbosch/projects/angular2/modules/angular2/src/core/zone/vm_turn_zone.es6","sourceRoot":"/Users/tbosch/projects/angular2/modules/angular2/src/core/zone/","sourcesContent":["import {List, ListWrapper, StringMapWrapper} from 'angular2/src/facade/collection';\nimport {normalizeBlank, isPresent, global} from 'angular2/src/facade/lang';\n\nexport class VmTurnZone {\n  _outerZone;\n  _innerZone;\n\n  _onTurnStart:Function;\n  _onTurnDone:Function;\n  _onErrorHandler:Function;\n\n  _nestedRunCounter:number;\n\n  constructor({enableLongStackTrace}) {\n    this._nestedRunCounter = 0;\n    this._onTurnStart = null;\n    this._onTurnDone = null;\n    this._onErrorHandler = null;\n\n    this._outerZone = global.zone;\n    this._innerZone = this._createInnerZone(this._outerZone, enableLongStackTrace);\n  }\n\n  initCallbacks({onTurnStart, onTurnDone, onScheduleMicrotask, onErrorHandler} = {}) {\n    this._onTurnStart = normalizeBlank(onTurnStart);\n    this._onTurnDone = normalizeBlank(onTurnDone);\n    this._onErrorHandler = normalizeBlank(onErrorHandler);\n  }\n\n  run(fn) {\n    return this._innerZone.run(fn);\n  }\n\n  runOutsideAngular(fn) {\n    return this._outerZone.run(fn);\n  }\n\n  _createInnerZone(zone, enableLongStackTrace) {\n    var vmTurnZone = this;\n    var errorHandling;\n\n    if (enableLongStackTrace) {\n      errorHandling = StringMapWrapper.merge(Zone.longStackTraceZone, {\n        onError: function (e) {\n          vmTurnZone._onError(this, e)\n        }\n      });\n    } else {\n      errorHandling = {\n        onError: function (e) {\n          vmTurnZone._onError(this, e)\n        }\n      };\n    }\n\n    return zone.fork(errorHandling).fork({\n      beforeTask: () => {this._beforeTask()},\n      afterTask: () => {this._afterTask()}\n    });\n  }\n\n  _beforeTask(){\n    this._nestedRunCounter ++;\n    if(this._nestedRunCounter === 1 && this._onTurnStart) {\n      this._onTurnStart();\n    }\n  }\n\n  _afterTask(){\n    this._nestedRunCounter --;\n    if(this._nestedRunCounter === 0 && this._onTurnDone) {\n      this._onTurnDone();\n    }\n  }\n\n  _onError(zone, e) {\n    if (isPresent(this._onErrorHandler)) {\n      var trace = [normalizeBlank(e.stack)];\n\n      while (zone && zone.constructedAtException) {\n        trace.push(zone.constructedAtException.get());\n        zone = zone.parent;\n      }\n      this._onErrorHandler(e, trace);\n    } else {\n      throw e;\n    }\n  }\n}","Object.defineProperties(module.exports, $__placeholder__0);","{get: $__placeholder__0}","get $__placeholder__0() { return $__placeholder__1; }","__esModule: true","{value: $__placeholder__0}","var __moduleName = $__placeholder__0;","($__placeholder__0 = require($__placeholder__1),\n        $__placeholder__2 && $__placeholder__3.__esModule && $__placeholder__4 || {default: $__placeholder__5})","var $__placeholder__0 = $__placeholder__1","($traceurRuntime.createClass)($__placeholder__0, $__placeholder__1, $__placeholder__2)"]}